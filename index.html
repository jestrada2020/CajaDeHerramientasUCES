<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kit de Matemáticas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.12.0/math.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #0c0a09;
            --background-color: #f8f9fa;
            --text-color: #2c3e50;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
        }
        #sidebar {
            width: 250px;
            background: white;
            padding: 2rem 1.5rem;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
        }
        #sidebar h2 {
            color: var(--primary-color);
            margin-bottom: 2rem;
            font-size: 1.5rem;
            font-weight: 600;
        }
        #sidebar ul {
            list-style: none;
        }
        #sidebar li {
            margin-bottom: 0.75rem;
        }
        #sidebar button {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            background: var(--secondary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        #sidebar button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        #content {
            flex: 1;
            margin-left: 250px;
            padding: 3rem;
        }
        .tool-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .function-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
        }
        .function-section h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        input, select {
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 1rem;
            border: 1px solid #ddd;
            border-radius: 6px;
            transition: border-color 0.3s ease;
        }
        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 2px rgba(52,152,219,0.2);
        }
        button {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        button:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }
        .result {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 6px;
            font-family: monospace;
            color: var(--accent-color);
        }
        .matrix-columns {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }
        .matrix-column {
            border: 1px solid #ddd;
            padding: 1rem;
            border-radius: 8px;
        }
        .matrix-column h4 {
            margin-bottom: 1rem;
        }
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            #sidebar {
                width: 100%;
                height: auto;
                position: relative;
                padding: 1.5rem;
            }
            #content {
                margin-left: 0;
                padding: 2rem 1.5rem;
            }
            .matrix-columns {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="sidebar">
        <h2>Kit de Matemáticas Uno</h2>
        <div class="list-group">
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('welcome')">Inicio</button>
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('AlgebraElemental1')">Algebra básica</button>
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('trigo1')">Trigonometría básica</button>
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('Determinantes')">Sistemas 2 por 2 y Determinante 2 por 2</button>
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('matrices')">Multiplicación de Matrices</button>
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('gauss-jordan')">Método Gauss-Jordan</button>
            <button class="list-group-item list-group-item-action mb-2" onclick="app.loadTool('g_Geogebra')">Geogebra Clasico</button>
        </div>
    </div>

    <div id="content">
        <div id="welcome" class="tool-container">
            <div class="function-section">
                <h2>Bienvenido al kit de  Matemáticas</h2>
                        <h3>Introducción a la Caja de Herramientas</h3>
                        <p>Hace algún tiempo el profesor Carlos Andrés Escobar Guerra propuso la creación de unas cartillas para los cursos de matemáticas de la facultad de Ciencias y Biotecnología, la elaboración de las cartillas produjo la necesidad de tener las herramientas para desarrollar las actividades de dicha cartilla.</p>
                        <p>Así es que se llegó a la creación de una caja de herramientas donde se encontraran aplicaciones de aritmética, matemáticas I, II y III, y aplicaciones más avanzadas, la caja de herramientas hace más dinámica la clase, hace que los estudiantes adquieran los saberes esenciales más rápidamente, depende del profesor y de los estudiantes no pasar por alto los detalles que conducen a la solución.</p>
                        <p>Para solucionar muchos de los ejercicios y problemas no es necesario ser un gran estudiante en matemáticas, eso sí, debe saber interiorizar, entender los conceptos que ayudan a solucionar el problema y en la caja de herramientas encontrará los instrumentos que le ayudaran a solucionar los problemas; depende del alumno escoger la herramienta adecuada.</p>
                        <p>Otra ventaja de la caja de herramientas es que las aplicaciones se pueden encontrar en un sólo espacio virtual y diseñadas de acuerdo a las necesidades de nuestros estudiantes, para la construcción de las herramientas se utilizó R, LaTeX, Flexdashboard, Bookdown, Shiny, y Geogebra.</p>
                        <p>Se puede decir que el equipo de trabajo está conformado por el profesor Carlos Andrés Escobar Guerra, Pablo Andrés Guzmán, John Jairo Estrada Álvarez y Juan Albero Arias Quiceno. Gracias a la invaluable ayuda del profesor de estadística y programación Pablo Andrés Guzmán puesto que él inspiró la creación de un grupo de estudio en el cual compartía sus conocimientos de R, de otros programas y actualmente da su opinión acerca de las nuevas aplicaciones. John Jairo Estrada, el cerebro del proyecto, es el programador de todas las aplicaciones.</p>
                <p>Selecciona una herramienta del menú lateral para comenzar.</p>
            </div>
        </div>

        
        
        <div id="AlgebraElemental1" class="tool-container" style="display: none;">
            <div class="function-section">
                <h2>Bienvenido al álgebra básica (ó álgebra elemental)</h2>


                <div class="matrix-columns">
                    <div class="matrix-column">
                        <h4>Función polinómica</h4> 
                        <div class="mb-4">
                            <p>Ingresa una función algebraica y evalúala para un valor específico de x.</p>
                        <div class="function-evaluator">
                            <input 
                                type="text" 
                                id="functionExpression" 
                                placeholder="Ingresa una función (ejemplo: 2*x^2 + 3*x - 1)"
                                pattern="[-+*/^().\dx\s]+"
                                required
                            >
                        </div>
                                <input 
                                    type="number" 
                                    id="xValue" 
                                    placeholder="Valor de x"
                                    required
                                >
                        <div class="precision-control">
                            <label for="polynomialPrecision">Precisión (0-15):</label>
                            <input 
                                type="number" 
                                id="polynomialPrecision" 
                                value="0" 
                                min="0" 
                                max="15"
                                required
                            >
                        </div>
                        <button onclick="AlgebraElemental1.evaluateFunction()">Evaluar</button>
                        <p id="polynomialResult" class="result"></p>
                        </div>       
                    </div>



                    <div class="matrix-column">
                        <h4>Función Racional</h4>
                        <div class="mb-4">
                            <p>Ingresa el numerador y denominador de la función racional en términos de x, y evalúala para un valor específico de x.</p>
                            <input type="text" id="numeratorExpression" placeholder="Ingresa el numerador (por ejemplo: x^2 + 3)">
                            <input type="text" id="denominatorExpression" placeholder="Ingresa el denominador (por ejemplo: x - 2)">
                            <input type="number" id="xValueRational" placeholder="Valor de x">
                            <div class="precision-control">
                                <label for="rationalPrecision">Precisión:</label>
                                <input type="number" id="rationalPrecision" value="0" min="0" max="15">
                            </div>
                            <button onclick="AlgebraElemental1.evaluateRationalFunction()">Evaluar</button>
                            <p id="rationalResult" class="result"></p>
                        </div>
                    </div>



                   <div class="matrix-column">
                        <h4>Ecuación Cuadrática</h4>
                        <div class="mb-4">
                            <p>Ingresa los coeficientes A, B y C de la ecuación cuadrática</p>
                            <p> Ax² + Bx + C = 0</p>
                            <div class="coefficient-inputs">
                                <input type="number" id="coefficientA" placeholder="A">
                                <input type="number" id="coefficientB" placeholder="B">
                                <input type="number" id="coefficientC" placeholder="C">
                            </div>
                            <div class="precision-control">
                                <label for="quadraticPrecision">Precisión:</label>
                                <input type="number" id="quadraticPrecision" value="0" min="0" max="15">
                            </div>
                            <button onclick="AlgebraElemental1.solveQuadraticEquation()">Resolver</button>
                            <p id="discriminantResult" class="result"></p>
                            <p id="sqrtDiscriminantResult" class="result"></p>
                            <p id="vertexResult" class="result"></p> </div>
                            <p id="quadraticRootsResult" class="result"></p> 

                    </div>



                </div>                        

                <div class="matrix-columns">
                    <div class="matrix-column">
                        <h4>Tabla para Funciones</h4>
                        <p>Ingresa una función, un intervalo y un tamaño de paso para generar una tabla de valores.</p>
                        <input type="text" id="tableFunctionExpression" placeholder="Ingresa una función (por ejemplo: sin(x))">
                        <input type="number" id="startInterval" placeholder="Valor inicial del intervalo">
                        <input type="number" id="endInterval" placeholder="Valor final del intervalo">
                        <input type="number" id="stepSize" placeholder="Tamaño del paso">
                        <div class="precision-control">
                            <label for="tablePrecision">Precisión:</label>
                            <input type="number" id="tablePrecision" value="0" min="0" max="15">
                        </div>
                        <button onclick="AlgebraElemental1.generateTable()">Generar Tabla</button>
                        <div id="tableResult"></div>

                    </div>
                </div> 


            </div>        
        </div>



        <div id="trigo1" class="tool-container" style="display: none;">
            <div class="function-section">
                <h2>Bienvenido a la Trigonometría básica </h2>


                <p>Calcula funciones trigonométricas.</p>
                <input type="number" id="angle" placeholder="Ingresa un ángulo en grados">
                <select id="trigFunction">
                    <option value="sin">Seno</option>
                    <option value="cos">Coseno</option>
                    <option value="tan">Tangente</option>
                    <option value="csc">Cosecante</option>
                    <option value="sec">Secante</option>
                    <option value="cot">Cotangente</option>
                </select>
                <div class="precision-control">
                    <label for="trigPrecision">Precisión:</label>
                    <input type="number" id="trigPrecision" value="5" min="0" max="15">
                </div>
                <button onclick="trigo1.calculateTrig()">Calcular</button>
                <p id="trigResult" class="result"></p>

            </div>
        </div>



        <div id="g_Geogebra" class="tool-container" style="display: none;">
            <div class="function-section">
                <h2>Bienvenido al kit de Geogebra Clasico</h2>

                
                <h2>Aplicaciónes Geogebra </h2>
                
                <p> </p>
                <a href="https://www.geogebra.org/classic?lang=yi" target="_blank" class="button">
                    Abrir GeoGebra Geometría
                </a>

                <p> </p>

                <a href="https://www.geogebra.org/cas?lang=es" target="_blank" class="button">
                    Abrir GeoGebra Simbólico
                </a>


                <p> </p>

                <a href=" https://www.geogebra.org/m/D753wjWN" target="_blank" class="button">
                    Abrir GeoGebra Estadístico
                </a>








               
            </div>
        </div>

        
        
        



        <div id="Determinantes" class="tool-container" style="display: none;">
            <div class="function-section">
                <h2>Bienvenido al cálculo de sistemas 2x2 y determinantes 2x2</h2>

                <div class="function-section">
                    <h3>Multiplicación de Matrices</h3>
                    <div class="matrix-columns">
                        <div class="matrix-column">
                            <h4>Sistema 2 por 2</h4>
                            <div class="mb-4">

                                <div class="function-section" style="grid-column: 1; border: 1px solid #ccc; padding: 15px; border-radius: 5px;">
                                    <h3>Coeficientes Ecuación 1</h3>
                                    <div class="matrix-input">
                                        <input type="number" id="system2x2A11" placeholder="a11" style="width: 120px; margin: 5px;">
                                        <input type="number" id="system2x2A12" placeholder="a12" style="width: 120px; margin: 5px;">
                                        <input type="number" id="system2x2B1" placeholder="b1" style="width: 120px; margin: 5px;">
                                    </div>
                                </div>

                                <div class="function-section" style="grid-column: 2; border: 1px solid #ccc; padding: 15px; border-radius: 5px;">
                                    <h3>Coeficientes Ecuación 2</h3>
                                    <div class="matrix-input">
                                        <input type="number" id="system2x2A21" placeholder="a21" style="width: 120px; margin: 5px;">
                                        <input type="number" id="system2x2A22" placeholder="a22" style="width: 120px; margin: 5px;">
                                        <input type="number" id="system2x2B2" placeholder="b2" style="width: 120px; margin: 5px;">
                                    </div>
                                </div>

                                <div class="function-section" style="grid-column: 3; border: 1px solid #ccc; padding: 15px; border-radius: 5px;">
                                    <h3>Control de Precisión</h3>
                                    <div class="precision-control">
                                        <label for="system2x2Precision">Precisión:</label>
                                        <input type="number" id="system2x2Precision" value="0" min="0" max="15" style="width: 60px; margin: 5px;">
                                    </div>
                                    <button onclick="Determinantes.solveSystem2x2()" style="margin-top: 10px; padding: 8px 15px;">Resolver Sistema</button>
                                </div>

                                <!-- Segunda fila -->
                                <div class="result-section" style="grid-column: 1 / span 3; border: 1px solid #ccc; padding: 15px; border-radius: 5px;">
                                    <h3>Resultado del Sistema</h3>
                                    <p id="systemResult2x2" class="result"></p>
                                </div>

                            </div>    
                        </div>

                        <div class="matrix-column">
                           <!--  <h4>Determinante matriz de coeficientes</h4> -->
                            <div class="mb-4">
                                <h3>Determinante de una Matriz 2x2</h3>
                                <p>Ingresa los elementos de la matriz 2x2 para calcular el determinante.</p>


                                <div class="function-section" style="grid-column: 1; border: 1px solid #ccc; padding: 15px; border-radius: 5px;">
                                    <h3>Coeficientes Ecuación 1</h3>
                                    <div class="matrix-input">
                                        <input type="number" id="matrixA11" placeholder="a11" style="width: 120px; margin: 5px;">
                                        <input type="number" id="matrixA12" placeholder="a12" style="width: 120px; margin: 5px;">
                                    </div>
                                </div>

                                <div class="function-section" style="grid-column: 2; border: 1px solid #ccc; padding: 15px; border-radius: 5px;">
                                    <h3>Coeficientes Ecuación 2</h3>
                                    <div class="matrix-input">
                                        <input type="number" id="matrixA21" placeholder="a21" style="width: 120px; margin: 5px;">
                                        <input type="number" id="matrixA22" placeholder="a22" style="width: 120px; margin: 5px;">
                                    </div>
                                </div>

                                <div class="precision-control">
                                    <label for="determinant2x2Precision">Precisión:</label>
                                    <input type="number" id="determinant2x2Precision" value="0" min="0" max="15">
                                </div>
                                <button onclick="Determinantes.calculateDeterminant2x2()">Calcular Determinante</button>
                                <p id="determinantResult2x2" class="result"></p>
                            </div>  
                        </div>



                    </div>
                </div>
                        
            </div>
        </div>

        <div id="matrices" class="tool-container" style="display: none;">
            <div class="function-section">
                <h3>Multiplicación de Matrices</h3>
                <div class="alert alert-info">
                    Puedes usar números enteros, decimales o fracciones (por ejemplo: 1/2, 3/4)
                </div>
                <div class="matrix-columns">
                    <div class="matrix-column">
                        <h4>Matriz A</h4>
                        <div class="mb-3">
                            <label class="form-label">Dimensiones:</label>
                            <div class="d-flex gap-2">
                                <input type="number" id="rowsA" class="form-control" value="2" min="1" max="5">
                                <span class="align-self-center">×</span>
                                <input type="number" id="colsA" class="form-control" value="2" min="1" max="5">
                            </div>
                        </div>
                        <div id="matrixA" class="matrix-input"></div>
                    </div>
                    <div class="matrix-column">
                        <h4>Matriz B</h4>
                        <div class="mb-3">
                            <label class="form-label">Dimensiones:</label>
                            <div class="d-flex gap-2">
                                <input type="number" id="rowsB" class="form-control" value="2" min="1" max="5">
                                <span class="align-self-center">×</span>
                                <input type="number" id="colsB" class="form-control" value="2" min="1" max="5">
                            </div>
                        </div>
                        <div id="matrixB" class="matrix-input"></div>
                    </div>
                    <div class="matrix-column">
                        <h4>Matriz C</h4>
                        <div class="mb-3">
                            <label class="form-label">Dimensiones:</label>
                            <div class="d-flex gap-2">
                                <input type="number" id="rowsC" class="form-control" value="2" min="1" max="5">
                                <span class="align-self-center">×</span>
                                <input type="number" id="colsC" class="form-control" value="2" min="1" max="5">
                            </div>
                        </div>
                        <div id="matrixC" class="matrix-input"></div>
                    </div>
                </div>
                <div class="mt-3">
                    <button class="btn btn-primary me-2" onclick="matrices.generateInputs()">Generar Matrices</button>
                    <button class="btn btn-success" onclick="matrices.calculate()">Calcular</button>
                </div>
                <div id="matrixResult" class="mt-3"></div>
            </div>
        </div>

        <div id="gauss-jordan" class="tool-container" style="display: none;">
            <div class="function-section">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-body">
                                <h4>Dimensiones del Sistema</h4>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="form-label">Ecuaciones:</label>
                                        <input type="number" id="gaussRows" class="form-control" value="3" min="2" max="5">
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Variables:</label>
                                        <input type="number" id="gaussCols" class="form-control" value="3" min="2" max="5">
                                    </div>
                                </div>
                                <button class="btn btn-primary w-100 mt-3" onclick="gauss.updateMatrix()">Actualizar</button>
                            </div>
                        </div>
                        <div class="card mt-3">
                            <div class="card-body">
                                <h4>Sistema de Ecuaciones</h4>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="useFractions" checked>
                                        <label class="form-check-label">Usar Fracciones</label>
                                    </div>
                                </div>
                                <div id="gaussInputs" class="matrix-input"></div>
                                <button class="btn btn-primary w-100 mt-3" onclick="gauss.generate()">Generar Sistema</button>
                            </div>
                        </div>
                        <div class="card mt-3">
                            <div class="card-body">
                                <h4>Operaciones</h4>
                                <select id="operationType" class="form-select mb-3">
                                    <option value="multiply">Multiplicar fila por escalar</option>
                                    <option value="add">Sumar múltiplo de una fila a otra</option>
                                    <option value="swap">Intercambiar filas</option>
                                </select>
                                <div id="operationInputs"></div>
                                <button class="btn btn-success w-100 mt-2" onclick="gauss.applyOperation()">Aplicar</button>
                                <button class="btn btn-warning w-100 mt-2" onclick="gauss.undo()">Deshacer</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-body">
                                <h4>Sistema Actual</h4>
                                <div id="currentSystem" class="matrix-display"></div>
                            </div>
                        </div>
                        <div class="card mt-3">
                            <div class="card-body">
                                <h4>Matriz Aumentada</h4>
                                <div id="augmentedMatrix" class="matrix-display"></div>
                            </div>
                        </div>
                        <div class="card mt-3">
                            <div class="card-body">
                                <h4>Historial</h4>
                                <pre id="operationHistory" class="mt-3">No hay operaciones realizadas</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const app = {
            currentTool: 'welcome',
            loadTool(tool) {
                ['welcome','AlgebraElemental1','trigo1','Determinantes', 'matrices', 'gauss-jordan','g_Geogebra'].forEach(t => {
                    document.getElementById(t).style.display = t === tool ? 'block' : 'none';
                });
                this.currentTool = tool;
            }
        };

        const AlgebraElemental1 = {
            evaluateFunction() {
                const expression = document.getElementById('functionExpression').value;
                const xValue = parseFloat(document.getElementById('xValue').value);
                const precision = parseInt(document.getElementById('polynomialPrecision').value);
                const resultElement = document.getElementById('polynomialResult');

                if (!expression) {
                    resultElement.textContent = 'Error: Por favor ingresa una expresión válida.';
                    return;
                }
                if (isNaN(xValue)) {
                    resultElement.textContent = 'Error: Por favor ingresa un valor numérico válido para x.';
                    return;
                }

                try {
                    // Usar la variable math global proporcionada por el script incluido
                    const parsedExpression = math.parse(expression);
                    const compiledExpression = parsedExpression.compile();
                    const result = compiledExpression.evaluate({ x: xValue });
                    resultElement.textContent = `Resultado: ${result.toFixed(precision)}`;
                } catch (error) {
                    resultElement.textContent = 'Error: La expresión no se pudo evaluar. Por favor verifica la sintaxis.';
                }
            },

            evaluateRationalFunction() {
                const numerator = document.getElementById('numeratorExpression').value;
                const denominator = document.getElementById('denominatorExpression').value;
                const xValue = parseFloat(document.getElementById('xValueRational').value);
                const precision = parseInt(document.getElementById('rationalPrecision').value);
                const resultElement = document.getElementById('rationalResult');

                if (!numerator || !denominator) {
                    resultElement.textContent = 'Error: Por favor ingresa expresiones válidas para el numerador y el denominador.';
                    return;
                }
                if (isNaN(xValue)) {
                    resultElement.textContent = 'Error: Por favor ingresa un valor numérico válido para x.';
                    return;
                }

                try {
                    const parsedNumerator = math.parse(numerator);
                    const parsedDenominator = math.parse(denominator);
                    const compiledNumerator = parsedNumerator.compile();
                    const compiledDenominator = parsedDenominator.compile();
                    const numeratorValue = compiledNumerator.evaluate({ x: xValue });
                    const denominatorValue = compiledDenominator.evaluate({ x: xValue });

                    if (denominatorValue === 0) {
                        resultElement.textContent = 'Error: División por cero.';
                        return;
                    }

                    const result = numeratorValue / denominatorValue;
                    resultElement.textContent = `Resultado: ${result.toFixed(precision)}`;
                } catch (error) {
                    resultElement.textContent = 'Error: Las expresiones no se pudieron evaluar. Por favor verifica la sintaxis.';
                }
            },

            generateTable() {
                const expression = document.getElementById('tableFunctionExpression').value;
                const startInterval = parseFloat(document.getElementById('startInterval').value);
                const endInterval = parseFloat(document.getElementById('endInterval').value);
                const stepSize = parseFloat(document.getElementById('stepSize').value);
                const precision = parseInt(document.getElementById('tablePrecision').value);
                const resultElement = document.getElementById('tableResult');

                if (!expression) {
                    resultElement.innerHTML = 'Error: Por favor ingresa una expresión válida.';
                    return;
                }
                if (isNaN(startInterval) || isNaN(endInterval) || isNaN(stepSize) || stepSize <= 0) {
                    resultElement.innerHTML = 'Error: Por favor ingresa valores numéricos válidos para el intervalo y el tamaño del paso.';
                    return;
                }

                try {
                    const parsedExpression = math.parse(expression);
                    const compiledExpression = parsedExpression.compile();
                    let tableContent = `<table><thead><tr><th>x</th><th>f(x)</th></tr></thead><tbody>`;

                    for (let x = startInterval; x <= endInterval; x += stepSize) {
                        const y = compiledExpression.evaluate({ x: x });
                        tableContent += `<tr><td>${x.toFixed(precision)}</td>   <td>${y.toFixed(precision)}</td></tr>`;
                    }

                    tableContent += 
                    `</tbody> 
                    <td style="width: 50px"></td>
                    <td style="width: 50px"></td>
                     </table>`;
                    resultElement.innerHTML = tableContent;
                } catch (error) {
                    resultElement.innerHTML = 'Error: La expresión no se pudo evaluar. Por favor verifica la sintaxis.';
                }
            },

            solveQuadraticEquation() {
                const a = parseFloat(document.getElementById('coefficientA').value);
                const b = parseFloat(document.getElementById('coefficientB').value);
                const c = parseFloat(document.getElementById('coefficientC').value);
                const precision = parseInt(document.getElementById('quadraticPrecision').value);
                const discriminantResult = document.getElementById('discriminantResult');
                const sqrtDiscriminantResult = document.getElementById('sqrtDiscriminantResult');
                const vertexResult = document.getElementById('vertexResult');
                const quadraticRootsResult = document.getElementById('quadraticRootsResult');

                if (isNaN(a) || isNaN(b) || isNaN(c)) {
                    discriminantResult.textContent = 'Error: Por favor ingresa valores numéricos válidos para A, B y C.';
                    return;
                }

                const discriminant = b * b - 4 * a * c;
                discriminantResult.textContent = `Discriminante (D): ${discriminant.toFixed(precision)}`;

                if (discriminant > 0) {
                    const sqrtD = Math.sqrt(discriminant);
                    sqrtDiscriminantResult.textContent = `Raíz del discriminante: ${sqrtD.toFixed(precision)}`;
                    const root1 = (-b + sqrtD) / (2 * a);
                    const root2 = (-b - sqrtD) / (2 * a);
                    quadraticRootsResult.textContent = `Raíces reales: x1 = ${root1.toFixed(precision)}, x2 = ${root2.toFixed(precision)}`;
                } else if (discriminant === 0) {
                    const root = -b / (2 * a);
                    sqrtDiscriminantResult.textContent = `Raíz del discriminante: 0`;
                    quadraticRootsResult.textContent = `Raíz única: x = ${root.toFixed(precision)}`;
                } else {
                    const sqrtD = Math.sqrt(-discriminant);
                    sqrtDiscriminantResult.textContent = `Raíz del discriminante: i * ${sqrtD.toFixed(precision)}`;
                    const realPart = -b / (2 * a);
                    const imaginaryPart = sqrtD / (2 * a);
                    quadraticRootsResult.textContent = `Raíces complejas: x1 = ${realPart.toFixed(precision)} + i * ${imaginaryPart.toFixed(precision)}, x2 = ${realPart.toFixed(precision)} - i * ${imaginaryPart.toFixed(precision)}`;
                }

                const vertexX = -b / (2 * a);
                const vertexY = (4 * a * c - b * b) / (4 * a);
                vertexResult.textContent = `Vértice: V(${vertexX.toFixed(precision)}, ${vertexY.toFixed(precision)})`;
            },

        };




        const trigo1 ={

            calculateTrig() {
                const angle = parseFloat(document.getElementById('angle').value);
                const functionType = document.getElementById('trigFunction').value;
                const precision = parseInt(document.getElementById('trigPrecision').value);
                const resultElement = document.getElementById('trigResult');

                if (isNaN(angle)) {
                    resultElement.textContent = 'Por favor, ingresa un ángulo válido.';
                    return;
                }

                let result;
                const radians = angle * (Math.PI / 180);
                switch (functionType) {
                    case 'sin':
                        result = Math.sin(radians);
                        break;
                    case 'cos':
                        result = Math.cos(radians);
                        break;
                    case 'tan':
                        result = Math.tan(radians);
                        break;
                    case 'csc':
                        result = 1 / Math.sin(radians);
                        break;
                    case 'sec':
                        result = 1 / Math.cos(radians);
                        break;
                    case 'cot':
                        result = 1 / Math.tan(radians);
                        break;
                    default:
                        resultElement.textContent = 'Función no válida.';
                        return;
                }

                resultElement.textContent = `Resultado: ${result.toFixed(precision)}`;
            },
        };



        const g_Geogebra ={

            initGeogebra() {
                var params = {
                    "appName": "OOR7QQOe",
                    "width": 800,
                    "height": 600,
                    "showToolBar": true,
                    "showAlgebraInput": true,
                    "showMenuBar": true,
                    "showResetIcon": true,
                    "enableLabelDrags": false,
                    "enableShiftDragZoom": true,
                    "enableRightClick": false,
                    "showToolBarHelp": false,
                    "errorDialogsActive": true,
                    "useBrowserForJS": true,
                    "allowStyleBar": false,
                    "preventFocus": false,
                    "showZoomButtons": true,
                    "capturingThreshold": 3,
                    "showFullscreenButton": true,
                    "scale": 1,
                    "disableAutoScale": false,
                    "language": "es",
                    "borderColor": "#ccc",
                    "buttonShadows": false,
                    "buttonRounding": 0.7
                };

                var applet = new GGBApplet(params, true);
                applet.inject('ggb-element');
            
                if (typeof GGBApplet === 'undefined') {
                    const script = document.createElement('script');
                    script.src = 'https://www.geogebra.org/apps/deployggb.js';
                    script.async = true;
                    script.onload = function() {
                        setTimeout(initGeogebra, 100); // Pequeño retraso para asegurar que todo esté cargado
                    };
                    script.onerror = function() {
                        document.getElementById('ggb-element').innerHTML = 
                            '<p>Error al cargar Geogebra. Por favor, revise su conexión a internet y recargue la página.</p>';
                    };
                    document.head.appendChild(script);
                } else {
                    setTimeout(initGeogebra, 100);
                }
            
            },
        };




        const Determinantes = {

                    solveSystem2x2() {
                        const a11 = parseFloat(document.getElementById('system2x2A11').value);
                        const a12 = parseFloat(document.getElementById('system2x2A12').value);
                        const b1 = parseFloat(document.getElementById('system2x2B1').value);
                        const a21 = parseFloat(document.getElementById('system2x2A21').value);
                        const a22 = parseFloat(document.getElementById('system2x2A22').value);
                        const b2 = parseFloat(document.getElementById('system2x2B2').value);
                        const precision = parseInt(document.getElementById('system2x2Precision').value);
                        const resultElement = document.getElementById('systemResult2x2');

                        if (isNaN(a11) || isNaN(a12) || isNaN(b1) || isNaN(a21) || isNaN(a22) || isNaN(b2)) {
                            resultElement.textContent = 'Error: Por favor ingresa todos los valores numéricos del sistema.';
                            return;
                        }

                        const matrixA = [
                            [a11, a12],
                            [a21, a22]
                        ];
                        const matrixB = [b1, b2];

                        try {
                            const solution = math.lusolve(matrixA, matrixB);
                            resultElement.textContent = `Solución:             x1 = ${solution[0][0].toFixed(precision)},   x2 = ${solution[1][0].toFixed(precision)}`;
                        } catch (error) {
                            resultElement.textContent = 'Error: No se pudo resolver el sistema.';
                        }
                    },



                    solveSystem3x3() {
                        const a11 = parseFloat(document.getElementById('system3x3A11').value);
                        const a12 = parseFloat(document.getElementById('system3x3A12').value);
                        const a13 = parseFloat(document.getElementById('system3x3A13').value);
                        const b1 = parseFloat(document.getElementById('system3x3B1').value);
                        const a21 = parseFloat(document.getElementById('system3x3A21').value);
                        const a22 = parseFloat(document.getElementById('system3x3A22').value);
                        const a23 = parseFloat(document.getElementById('system3x3A23').value);
                        const b2 = parseFloat(document.getElementById('system3x3B2').value);
                        const a31 = parseFloat(document.getElementById('system3x3A31').value);
                        const a32 = parseFloat(document.getElementById('system3x3A32').value);
                        const a33 = parseFloat(document.getElementById('system3x3A33').value);
                        const b3 = parseFloat(document.getElementById('system3x3B3').value);
                        const precision = parseInt(document.getElementById('system3x3Precision').value);
                        const resultElement = document.getElementById('systemResult3x3');
        
                        if (isNaN(a11) || isNaN(a12) || isNaN(a13) || isNaN(b1) ||
                            isNaN(a21) || isNaN(a22) || isNaN(a23) || isNaN(b2) ||
                            isNaN(a31) || isNaN(a32) || isNaN(a33) || isNaN(b3)) {
                            resultElement.textContent = 'Error: Por favor ingresa todos los valores numéricos del sistema.';
                            return;
                        }
        
                        const matrixA = [
                            [a11, a12, a13],
                            [a21, a22, a23],
                            [a31, a32, a33]
                        ];
                        const matrixB = [b1, b2, b3];
        
                        try {
                            const solution = math.lusolve(matrixA, matrixB);
                            resultElement.textContent = `Solución: x1 = ${solution[0][0].toFixed(precision)}, x2 = ${solution[1][0].toFixed(precision)}, x3 = ${solution[2][0].toFixed(precision)}`;
                        } catch (error) {
                            resultElement.textContent = 'Error: No se pudo resolver el sistema.';
                        }
                    },
        
                    solveSystem4x4() {
                        const a11 = parseFloat(document.getElementById('system4x4A11').value);
                        const a12 = parseFloat(document.getElementById('system4x4A12').value);
                        const a13 = parseFloat(document.getElementById('system4x4A13').value);
                        const a14 = parseFloat(document.getElementById('system4x4A14').value);
                        const b1 = parseFloat(document.getElementById('system4x4B1').value);
                        const a21 = parseFloat(document.getElementById('system4x4A21').value);
                        const a22 = parseFloat(document.getElementById('system4x4A22').value);
                        const a23 = parseFloat(document.getElementById('system4x4A23').value);
                        const a24 = parseFloat(document.getElementById('system4x4A24').value);
                        const b2 = parseFloat(document.getElementById('system4x4B2').value);
                        const a31 = parseFloat(document.getElementById('system4x4A31').value);
                        const a32 = parseFloat(document.getElementById('system4x4A32').value);
                        const a33 = parseFloat(document.getElementById('system4x4A33').value);
                        const a34 = parseFloat(document.getElementById('system4x4A34').value);
                        const b3 = parseFloat(document.getElementById('system4x4B3').value);
                        const a41 = parseFloat(document.getElementById('system4x4A41').value);
                        const a42 = parseFloat(document.getElementById('system4x4A42').value);
                        const a43 = parseFloat(document.getElementById('system4x4A43').value);
                        const a44 = parseFloat(document.getElementById('system4x4A44').value);
                        const b4 = parseFloat(document.getElementById('system4x4B4').value);
                        const precision = parseInt(document.getElementById('system4x4Precision').value);
                        const resultElement = document.getElementById('systemResult4x4');
        
                        if (isNaN(a11) || isNaN(a12) || isNaN(a13) || isNaN(a14) ||
                            isNaN(b1) || isNaN(a21) || isNaN(a22) || isNaN(a23) ||
                            isNaN(a24) || isNaN(b2) || isNaN(a31) || isNaN(a32) ||
                            isNaN(a33) || isNaN(a34) || isNaN(b3) || isNaN(a41) ||
                            isNaN(a42) || isNaN(a43) || isNaN(a44) || isNaN(b4)) {
                            resultElement.textContent = 'Error: Por favor ingresa todos los valores numéricos del sistema.';
                            return;
                        }
        
                        const matrixA = [
                            [a11, a12, a13, a14],
                            [a21, a22, a23, a24],
                            [a31, a32, a33, a34],
                            [a41, a42, a43, a44]
                        ];
                        const matrixB = [b1, b2, b3, b4];
        
                        try {
                            const solution = math.lusolve(matrixA, matrixB);
                            resultElement.textContent = `Solución: x1 = ${solution[0][0].toFixed(precision)}, x2 = ${solution[1][0].toFixed(precision)}, x3 = ${solution[2][0].toFixed(precision)}, x4 = ${solution[3][0].toFixed(precision)}`;
                        } catch (error) {
                            resultElement.textContent = 'Error: No se pudo resolver el sistema.';
                        }
                    },
        
                    calculateDeterminant2x2() {
                        const a11 = parseFloat(document.getElementById('matrixA11').value);
                        const a12 = parseFloat(document.getElementById('matrixA12').value);
                        const a21 = parseFloat(document.getElementById('matrixA21').value);
                        const a22 = parseFloat(document.getElementById('matrixA22').value);
                        const precision = parseInt(document.getElementById('determinant2x2Precision').value);
                        const resultElement = document.getElementById('determinantResult2x2');
        
                        if (isNaN(a11) || isNaN(a12) || isNaN(a21) || isNaN(a22)) {
                            resultElement.textContent = 'Error: Por favor ingresa todos los valores numéricos de la matriz.';
                            return;
                        }
        
                        const determinant = (a11 * a22) - (a12 * a21);
                        resultElement.textContent = `Determinante: ${determinant.toFixed(precision)}`;
                    },
        
                    calculateDeterminant3x3() {
                        const a11 = parseFloat(document.getElementById('matrix3x3A11').value);
                        const a12 = parseFloat(document.getElementById('matrix3x3A12').value);
                        const a13 = parseFloat(document.getElementById('matrix3x3A13').value);
                        const a21 = parseFloat(document.getElementById('matrix3x3A21').value);
                        const a22 = parseFloat(document.getElementById('matrix3x3A22').value);
                        const a23 = parseFloat(document.getElementById('matrix3x3A23').value);
                        const a31 = parseFloat(document.getElementById('matrix3x3A31').value);
                        const a32 = parseFloat(document.getElementById('matrix3x3A32').value);
                        const a33 = parseFloat(document.getElementById('matrix3x3A33').value);
                        const precision = parseInt(document.getElementById('determinant3x3Precision').value);
                        const resultElement = document.getElementById('determinantResult3x3');
        
                        if (isNaN(a11) || isNaN(a12) || isNaN(a13) || isNaN(a21) || isNaN(a22) || isNaN(a23) || isNaN(a31) || isNaN(a32) || isNaN(a33)) {
                            resultElement.textContent = 'Error: Por favor ingresa todos los valores numéricos de la matriz.';
                            return;
                        }
        
                        const determinant = a11 * (a22 * a33 - a23 * a32) - a12 * (a21 * a33 - a23 * a31) + a13 * (a21 * a32 - a22 * a31);
                        resultElement.textContent = `Determinante: ${determinant.toFixed(precision)}`;
                    },
        
                    calculateDeterminant4x4() {
                        const a11 = parseFloat(document.getElementById('matrix4x4A11').value);
                        const a12 = parseFloat(document.getElementById('matrix4x4A12').value);
                        const a13 = parseFloat(document.getElementById('matrix4x4A13').value);
                        const a14 = parseFloat(document.getElementById('matrix4x4A14').value);
                        const a21 = parseFloat(document.getElementById('matrix4x4A21').value);
                        const a22 = parseFloat(document.getElementById('matrix4x4A22').value);
                        const a23 = parseFloat(document.getElementById('matrix4x4A23').value);
                        const a24 = parseFloat(document.getElementById('matrix4x4A24').value);
                        const a31 = parseFloat(document.getElementById('matrix4x4A31').value);
                        const a32 = parseFloat(document.getElementById('matrix4x4A32').value);
                        const a33 = parseFloat(document.getElementById('matrix4x4A33').value);
                        const a34 = parseFloat(document.getElementById('matrix4x4A34').value);
                        const a41 = parseFloat(document.getElementById('matrix4x4A41').value);
                        const a42 = parseFloat(document.getElementById('matrix4x4A42').value);
                        const a43 = parseFloat(document.getElementById('matrix4x4A43').value);
                        const a44 = parseFloat(document.getElementById('matrix4x4A44').value);
                        const precision = parseInt(document.getElementById('determinant4x4Precision').value);
                        const resultElement = document.getElementById('determinantResult4x4');
        
                        if (isNaN(a11) || isNaN(a12) || isNaN(a13) || isNaN(a14) ||
                            isNaN(a21) || isNaN(a22) || isNaN(a23) || isNaN(a24) ||
                            isNaN(a31) || isNaN(a32) || isNaN(a33) || isNaN(a34) ||
                            isNaN(a41) || isNaN(a42) || isNaN(a43) || isNaN(a44)) {
                            resultElement.textContent = 'Error: Por favor ingresa todos los valores numéricos de la matriz.';
                            return;
                        }
        
                        // Calculating the determinant of a 4x4 matrix is more complex, using math.js
                        const matrix = [
                            [a11, a12, a13, a14],
                            [a21, a22, a23, a24],
                            [a31, a32, a33, a34],
                            [a41, a42, a43, a44]
                        ];
        
                        try {
                            const determinant = math.det(matrix);
                            resultElement.textContent = `Determinante: ${determinant.toFixed(precision)}`;
                        } catch (error) {
                            resultElement.textContent = 'Error: No se pudo calcular el determinante.';
                        }
                    },

        };







        function gcd(a, b) {
            a = Math.abs(a);
            b = Math.abs(b);
            while (b > 0) {
                [a, b] = [b, a % b];
            }
            return a;
        }

        function Fraction(num = 0, den = 1) {
            if (den === 0) return { num: 0, den: 1 };
            const d = gcd(Math.abs(num), Math.abs(den));
            if (den < 0) {
                num = -num;
                den = -den;
            }
            return { num: Math.floor(num / d), den: Math.floor(den / d) };
        }

        function parseFraction(str) {
            if (!str || str === '0') return Fraction(0, 1);
            if (str.includes('/')) {
                const [num, den] = str.split('/').map(x => parseInt(x.trim()));
                return Fraction(num || 0, den || 1);
            }
            const num = parseFloat(str);
            if (isNaN(num)) return Fraction(0, 1);
            if (Number.isInteger(num)) return Fraction(num, 1);
            const precision = 1000000;
            return Fraction(Math.round(num * precision), precision);
        }

        function formatFraction(frac) {
            if (frac.den === 1) return frac.num.toString();
            return `\\frac{${frac.num}}{${frac.den}}`;
        }

        function multiplyFractions(f1, f2) {
            return Fraction(f1.num * f2.num, f1.den * f2.den);
        }

        function addFractions(f1, f2) {
            const num = f1.num * f2.den + f2.num * f1.den;
            const den = f1.den * f2.den;
            return Fraction(num, den);
        }

        const matrices = {
            generateInputs() {
                ['A', 'B', 'C'].forEach(matrix => {
                    const rows = parseInt(document.getElementById(`rows${matrix}`).value);
                    const cols = parseInt(document.getElementById(`cols${matrix}`).value);
                    const container = document.getElementById(`matrix${matrix}`);
                    container.innerHTML = '';
                    
                    const table = document.createElement('table');
                    table.className = 'matrix-table';
                    
                    for (let i = 0; i < rows; i++) {
                        const tr = table.insertRow();
                        for (let j = 0; j < cols; j++) {
                            const td = tr.insertCell();
                            const input = document.createElement('input');
                            input.type = 'text';
                            input.className = 'form-control form-control-sm';
                            input.id = `${matrix}_${i}_${j}`;
                            input.value = '0';
                            td.appendChild(input);
                        }
                    }
                    container.appendChild(table);
                });
            },

            validateDimensions() {
                const rowsA = parseInt(document.getElementById('rowsA').value);
                const colsA = parseInt(document.getElementById('colsA').value);
                const rowsB = parseInt(document.getElementById('rowsB').value);
                const colsB = parseInt(document.getElementById('colsB').value);
                const rowsC = parseInt(document.getElementById('rowsC').value);
                const colsC = parseInt(document.getElementById('colsC').value);

                if (colsA !== rowsB || colsB !== rowsC) {
                    alert('Las dimensiones no son compatibles para multiplicación');
                    return false;
                }
                return true;
            },

            getMatrix(id) {
                const rows = parseInt(document.getElementById(`rows${id}`).value);
                const cols = parseInt(document.getElementById(`cols${id}`).value);
                const matrix = [];
                
                for (let i = 0; i < rows; i++) {
                    matrix[i] = [];
                    for (let j = 0; j < cols; j++) {
                        const input = document.getElementById(`${id}_${i}_${j}`);
                        matrix[i][j] = parseFraction(input.value);
                    }
                }
                return matrix;
            },

            multiply(A, B) {
                const result = [];
                for (let i = 0; i < A.length; i++) {
                    result[i] = [];
                    for (let j = 0; j < B[0].length; j++) {
                        result[i][j] = Fraction(0, 1);
                        for (let k = 0; k < A[0].length; k++) {
                            const prod = multiplyFractions(A[i][k], B[k][j]);
                            result[i][j] = addFractions(result[i][j], prod);
                        }
                    }
                }
                return result;
            },

            formatMatrix(matrix) {
                return `\\begin{pmatrix}
                    ${matrix.map(row => row.map(val => formatFraction(val)).join(' & ')).join(' \\\\ ')}
                \\end{pmatrix}`;
            },

            calculate() {
                if (!this.validateDimensions()) return;

                const A = this.getMatrix('A');
                const B = this.getMatrix('B');
                const C = this.getMatrix('C');
                
                const AB = this.multiply(A, B);
                const result = this.multiply(AB, C);

                document.getElementById('matrixResult').innerHTML = `
                    <h4>Producto intermedio (AB):</h4>
                    <div class="matrix-display">${this.formatMatrix(AB)}</div>
                    <h4>Resultado final (ABC):</h4>
                    <div class="matrix-display">${this.formatMatrix(result)}</div>
                `;
                
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, "matrixResult"]);
            }
        };

        const gauss = {
            rows: 3,
            cols: 3,
            matrix: [],
            history: [],
            steps: [],

            updateMatrix() {
                this.rows = parseInt(document.getElementById('gaussRows').value);
                this.cols = parseInt(document.getElementById('gaussCols').value);
                this.renderInputs();
                this.renderOperationInputs();
            },

            renderInputs() {
                const container = document.getElementById('gaussInputs');
                container.innerHTML = '';
                
                const table = document.createElement('table');
                table.className = 'matrix-table';
                
                for (let i = 0; i < this.rows; i++) {
                    const row = table.insertRow();
                    for (let j = 0; j < this.cols + 1; j++) {
                        const cell = row.insertCell();
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.className = 'form-control form-control-sm';
                        input.id = `gauss_${i}_${j}`;
                        input.value = '0';
                        cell.appendChild(input);
                    }
                }
                container.appendChild(table);
            },

            generate() {
                this.matrix = [];
                this.steps = [];
                this.history = [];

                for (let i = 0; i < this.rows; i++) {
                    this.matrix[i] = [];
                    for (let j = 0; j < this.cols + 1; j++) {
                        const input = document.getElementById(`gauss_${i}_${j}`);
                        this.matrix[i][j] = parseFraction(input.value);
                    }
                }

                this.steps.push(JSON.parse(JSON.stringify(this.matrix)));
                this.updateUI();
            },

            formatSystem() {
                return `\\begin{cases}
                    ${this.matrix.map(row => {
                        const terms = row.slice(0, -1).map((coef, idx) => {
                            if (coef.num === 0) return '';
                            return `${coef.num > 0 ? '+' : ''}${formatFraction(coef)}x_{${idx + 1}}`;
                        }).filter(term => term).join('') || '0';
                        return `${terms} = ${formatFraction(row[row.length - 1])}`;
                    }).join(' \\\\ ')}
                \\end{cases}`;
            },

            formatMatrix() {
                return `\\begin{pmatrix}
                    ${this.matrix.map(row => row.map(val => formatFraction(val)).join(' & ')).join(' \\\\ ')}
                \\end{pmatrix}`;
            },

            updateUI() {
                document.getElementById('currentSystem').innerHTML = `${this.formatSystem()}`;
                document.getElementById('augmentedMatrix').innerHTML = `${this.formatMatrix()}`;
                document.getElementById('operationHistory').textContent = 
                    this.history.length > 0 ? this.history.join('\n') : 'No hay operaciones realizadas';
                
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            },

            renderOperationInputs() {
                const container = document.getElementById('operationInputs');
                const type = document.getElementById('operationType').value;
                
                let html = '';
                if (type === 'multiply') {
                    html = `
                        <label class="form-label">Fila a multiplicar:</label>
                        <select class="form-select mb-2" id="multRow">
                            ${Array.from({length: this.rows}, (_, i) => 
                                `<option value="${i}">Fila ${i + 1}</option>`
                            ).join('')}
                        </select>
                        <label class="form-label">Escalar (fracción o decimal):</label>
                        <input type="text" class="form-control" id="scalar" value="1">
                    `;
                } else if (type === 'add') {
                    html = `
                        <label class="form-label">Fila origen:</label>
                        <select class="form-select mb-2" id="sourceRow">
                            ${Array.from({length: this.rows}, (_, i) => 
                                `<option value="${i}">Fila ${i + 1}</option>`
                            ).join('')}
                        </select>
                        <label class="form-label">Fila destino:</label>
                        <select class="form-select mb-2" id="targetRow">
                            ${Array.from({length: this.rows}, (_, i) => 
                                `<option value="${i}">Fila ${i + 1}</option>`
                            ).join('')}
                        </select>
                        <label class="form-label">Multiplicador (fracción o decimal):</label>
                        <input type="text" class="form-control" id="multiplier" value="1">
                    `;
                } else if (type === 'swap') {
                    html = `
                        <label class="form-label">Primera fila:</label>
                        <select class="form-select mb-2" id="row1">
                            ${Array.from({length: this.rows}, (_, i) => 
                                `<option value="${i}">Fila ${i + 1}</option>`
                            ).join('')}
                        </select>
                        <label class="form-label">Segunda fila:</label>
                        <select class="form-select mb-2" id="row2">
                            ${Array.from({length: this.rows}, (_, i) => 
                                `<option value="${i}">Fila ${i + 1}</option>`
                            ).join('')}
                        </select>
                    `;
                }
                container.innerHTML = html;
            },

            applyOperation() {
                const type = document.getElementById('operationType').value;
                
                if (type === 'multiply') {
                    const row = parseInt(document.getElementById('multRow').value);
                    const scalar = parseFraction(document.getElementById('scalar').value);
                    this.matrix[row] = this.matrix[row].map(val => multiplyFractions(val, scalar));
                    this.history.push(`F${row + 1} = ${formatFraction(scalar)} × F${row + 1}`);
                } 
                else if (type === 'add') {
                    const sourceRow = parseInt(document.getElementById('sourceRow').value);
                    const targetRow = parseInt(document.getElementById('targetRow').value);
                    const multiplier = parseFraction(document.getElementById('multiplier').value);
                    
                    this.matrix[targetRow] = this.matrix[targetRow].map((val, idx) => {
                        const term = multiplyFractions(this.matrix[sourceRow][idx], multiplier);
                        return addFractions(val, term);
                    });
                    this.history.push(`F${targetRow + 1} = F${targetRow + 1} + ${formatFraction(multiplier)} × F${sourceRow + 1}`);
                }
                else if (type === 'swap') {
                    const row1 = parseInt(document.getElementById('row1').value);
                    const row2 = parseInt(document.getElementById('row2').value);
                    [this.matrix[row1], this.matrix[row2]] = [this.matrix[row2], this.matrix[row1]];
                    this.history.push(`F${row1 + 1} ↔ F${row2 + 1}`);
                }

                this.steps.push(JSON.parse(JSON.stringify(this.matrix)));
                this.updateUI();
            },

            undo() {
                if (this.steps.length > 1) {
                    this.steps.pop();
                    this.matrix = JSON.parse(JSON.stringify(this.steps[this.steps.length - 1]));
                    this.history.pop();
                    this.updateUI();
                }
            }
        };









        // Inicialización
        document.addEventListener('DOMContentLoaded', () => {
            MathJax.Hub.Config({
                tex2jax: {
                    inlineMath: [['$', '$']],
                    displayMath: [['$$', '$$']]
                }
            });

            // Generar matrices iniciales
            matrices.generateInputs();

            // Inicializar Gauss-Jordan
            gauss.renderInputs();
            gauss.renderOperationInputs();

            // Event listeners
            document.getElementById('operationType')?.addEventListener('change', () => gauss.renderOperationInputs());

            // Matrix dimension change handlers
            ['A', 'B'].forEach((matrix, index) => {
                const nextMatrix = ['B', 'C'][index];
                document.getElementById(`cols${matrix}`).addEventListener('change', () => {
                    document.getElementById(`rows${nextMatrix}`).value = 
                        document.getElementById(`cols${matrix}`).value;
                    matrices.generateInputs();
                });
            });

            ['A', 'B', 'C'].forEach(matrix => {
                ['rows', 'cols'].forEach(dim => {
                    document.getElementById(`${dim}${matrix}`).addEventListener('change', () => matrices.generateInputs());
                });
            });
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>